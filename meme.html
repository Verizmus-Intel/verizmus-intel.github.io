<!doctype html>
<html lang="en">
<head>
  <meta charset="utf-8">
  <title>Verizmus Â· Regime Meme Forge</title>
  <link rel="icon" href="favicon.png" type="image/png">
  <!-- Impactâ€‘style font for classic meme look -->
  <link href="https://fonts.googleapis.com/css2?family=Anton&display=swap" rel="stylesheet">
  <style>
    :root{--bg:#0d0d0d;--fg:#fafafa;--accent:#f54747;--accent-dark:#c13333}
    *{box-sizing:border-box;margin:0;padding:0}
    body{background:var(--bg);color:var(--fg);font-family:'Inter',sans-serif;display:flex;flex-direction:column;align-items:center;min-height:100vh;padding:1rem}
    header{text-align:center;margin-bottom:1.2rem}
    header h1{font-size:2.2rem;font-weight:600;letter-spacing:.5px}
    header p{font-size:.9rem;color:#aaa;margin-top:.25rem}
    .forge{width:100%;max-width:780px;background:#151515;border:1px solid #282828;border-radius:8px;padding:1.4rem;box-shadow:0 0 10px #0008;display:flex;flex-direction:column;gap:1rem}
    canvas{width:100%;border:2px solid var(--accent);border-radius:6px;background:#000}
    .controls{display:grid;grid-template-columns:repeat(auto-fit,minmax(260px,1fr));gap:.9rem}
    label{font-size:.75rem;text-transform:uppercase;color:#bbb;letter-spacing:.8px}
    input[type=text],input[type=file],select{width:100%;padding:.55rem .75rem;background:#1e1e1e;border:1px solid #333;border-radius:4px;color:var(--fg);font-size:.9rem}
    button{align-self:center;padding:.8rem 1.8rem;background:var(--accent);color:#fff;font-weight:600;border:none;border-radius:4px;cursor:pointer;transition:.2s background}
    button:hover{background:var(--accent-dark)}
    footer{margin-top:1rem;font-size:.8rem;text-align:center;color:#666}
  </style>
</head>
<body>
<header>
  <h1>REGIME MEMEÂ FORGE</h1>
  <p>Create humiliation posters in seconds. Save.Â Deploy.</p>
</header>

<section class="forge">
  <canvas id="canvas" width="800" height="800"></canvas>

  <div class="controls">
    <div>
      <label for="template">Template</label>
      <select id="template">
        <option value="custom" selected>ğŸ”„Â Custom Upload</option>
        <option value="khamenei">Khamenei</option>
        <option value="irgc">IRGC</option>
        <option value="basiji">Basiji</option>
      </select>
    </div>
    <div>
      <label for="image">Upload Image</label>
      <input type="file" id="image" accept="image/*">
    </div>
    <div>
      <label for="top">Top Text</label>
      <input type="text" id="top" placeholder="TOP TEXT">
    </div>
    <div>
      <label for="bottom">Bottom Text</label>
      <input type="text" id="bottom" placeholder="BOTTOM TEXT">
    </div>
    <div>
      <label for="size">Font</label>
      <select id="size"><option>32</option><option>40</option><option>48</option><option selected>56</option><option>64</option></select>
    </div>
  </div>
  <button id="save">Download Meme</button>
</section>
<footer><a href="/index.html">â†Â BackÂ Home</a> Â· ğŸœÂ ğŸœÂ ğŸ¦</footer>

<script>
const templates={khamenei:'templates/khamenei.png',irgc:'templates/irgc.png',basiji:'templates/basiji.png'};
const canvas=document.getElementById('canvas');const ctx=canvas.getContext('2d');
const topT=document.getElementById('top'),bottomT=document.getElementById('bottom');
const imgInput=document.getElementById('image'),saveBtn=document.getElementById('save');
const sizeSel=document.getElementById('size'),tplSel=document.getElementById('template');
let img=new Image();img.crossOrigin='anonymous';img.onload=render;

function render(){
  ctx.clearRect(0,0,canvas.width,canvas.height);
  const ratio=Math.min(canvas.width/img.width,canvas.height/img.height);
  const w=img.width*ratio,h=img.height*ratio;
  ctx.drawImage(img,(canvas.width-w)/2,(canvas.height-h)/2,w,h);
  const f=parseInt(sizeSel.value);
  ctx.font=`bold ${f}px Anton, Impact, sans-serif`;
  ctx.textAlign='center';ctx.lineJoin='round';
  ctx.fillStyle='#ffffff';ctx.strokeStyle='#000000';ctx.lineWidth=Math.ceil(f/6);
  drawWrapped(topT.value.toUpperCase(),canvas.width/2,f,canvas.width-60,f*1.3,false);
  drawWrapped(bottomT.value.toUpperCase(),canvas.width/2,canvas.height-f/2,canvas.width-60,f*1.3,true);
  // watermark
  ctx.font='26px Anton';ctx.lineWidth=4;ctx.textAlign='right';ctx.fillText('ğŸœğŸœğŸ¦',canvas.width-12,canvas.height-12);
  ctx.strokeText('ğŸœğŸœğŸ¦',canvas.width-12,canvas.height-12);
}

function drawWrapped(text,x,y,maxWidth,lineHeight,fromBottom){
  if(!text) return;
  const words=text.split(' ');let line='';const lines=[];
  for(let i=0;i<words.length;i++){
    const test=line+words[i]+' ';
    if(ctx.measureText(test).width>maxWidth&&i>0){lines.push(line);line=words[i]+' ';}
    else{line=test;}
  }
  lines.push(line);
  const startY=fromBottom?y-lineHeight*(lines.length-1):y;
  lines.forEach((l,i)=>{
    const lineY=startY+i*lineHeight;
    ctx.strokeText(l.trim(),x,lineY);
    ctx.fillText(l.trim(),x,lineY);
  });
}

[topT,bottomT,sizeSel].forEach(el=>el.addEventListener('input',render));
imgInput.addEventListener('change',e=>{
  tplSel.value='custom';const reader=new FileReader();reader.onload=ev=>img.src=ev.target.result;reader.readAsDataURL(e.target.files[0]);});
tplSel.addEventListener('change',()=>{if(tplSel.value==='custom')return;img.src=templates[tplSel.value]||'https://picsum.photos/1200';});
saveBtn.addEventListener('click',()=>{const a=document.createElement('a');a.href=canvas.toDataURL('image/png');a.download='regime-meme.png';a.click();});
img.src='https://picsum.photos/1200';
</script>
</body>
</html>
